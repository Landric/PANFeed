{% extends "template.html" %}
{% load url from future %}
{% load crispy_forms_tags %}
{% block title %}Publish Special Issue{% endblock title %}
{% block publish_nav %}active{% endblock publish_nav %}
{% block content %}
{% if form.is_bound %}
    <h2>Edit Special Issue in "{{feed.title}}"</h2>
{% else %}
    <h2>Publish Special Issue to "{{feed.title}}"</h2>
{% endif %}
<br/>
<div ng:app="panfeedModule" ng:csp ng:controller="PublishCtrl">
    <form action="#" method="post" class="form-horizontal">
        {% csrf_token %}
        <fieldset>
            <div class='control-group'>
               <label class='control-label'>Special Issue title:</label>
                <div class='controls'>
                    <input type='text' name='issue-title' value=''/>
                </div>
            </div>

            <div class='control-group'>
                <label class='control-label'>Editorial:</label>
                <div class='controls'>
                   <textarea name='issue-editorial'></textarea>
                </div>
            </div>

            <div class="control-group">
                <div class="controls">
                    <textarea ng:model="url" placeholder="Enter URLs..."></textarea>
                    <button ng:click="doAJAX(url, 'x', 'items')" class="btn" type="button">Add URLs</button>
                </div>
            </div>
            <div ng:cloak class="well" id="items">
                <div class='control-group'>
                    <div class='controls'>
                        <div class='btn-group'>
                            <button type='button' class='btn' id='item-[[item.counter]]' title='Move this item up' alt='Move this item up' onclick='moveUpItem(\"item-"+itemCounter+"\")'><i class='icon-arrow-up'></i></button>
                            <button type='button' class='btn' id='item-[[item.counter]]' title='Move this item down' alt='Move this item down' onclick='moveDownItem(\"item-"+itemCounter+"\")'><i class='icon-arrow-down'></i></button>
                            <button type='button' class='btn' id='item-[[item.counter]]' title='Delete this item' alt='Delete this item' onclick='deleteItem(\"item-"+itemCounter+"\")'><i class='icon-trash'></i></button>
                        </div>
                    </div>
                </div>

                <div class='control-group'>
                    <label class='control-label'>URL:</label>
                    <div class='controls'>
                        <input class="disabled" type='text' name='item-url' value='[[item.url]]'/>
                    </div>
                </div>

                <div class='control-group'>
                    <label class='control-label'>Title:</label>
                    <div class='controls'>
                        <input type='text' name='item-title' value='[[item.title]]'/>
                    </div>
                </div>

                <div class='control-group'>
                    <label class='control-label'>Description:</label>
                    <div class='controls'>
                        <textarea name='item-description'>[[item.description]]</textarea>
                    </div>
                </div>

                <div class='control-group'>
                    <label class='control-label'>Image URL:</label>
                    <div class='controls'>
                        <div class='input-append'>
                            <input type='text' id='img-url-[[item.counter]]'  name='item-img' value='[[item.img]]'/><input type='button' class='btn' value='Update Image' onclick='changeImg(\"img-[[item.counter]]\", \"img-url-[[item.counter]]\")' />
                        </div>
                    </div>
                </div>

                <div class='control-group'>
                    <label class='control-label'>Image Preview:</label>
                    <div class='controls'>
                        <img id='img-[[item.counter]]' src='[[item.img' alt='URL does not resolve to image.' /><br />
                    </div>
                </div>

                <input type='hidden' name='item-ordernumber' value='[[ityem.counter]]' />
            </div>
            <div class="control-group">
                <div class="controls">
                    {% if form.is_bound %}
                        <input type="submit" value="Save" class="btn btn-primary"/>&nbsp;&nbsp;
                    {% else %}
                        <input type="submit" value="Publish" class="btn btn-primary disabled"/>&nbsp;&nbsp;
                    {% endif %}
                        <a href="{% url 'publishnews' %}" class="btn">Cancel</a>
                </div>
            </div>
        </fieldset>
    </form>
</div>
{% endblock content %}
